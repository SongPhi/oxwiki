(function(a){if(typeof exports=="object"&&typeof module=="object")a(require("../../lib/codemirror"),require("../python/python"),require("../stex/stex"),require("../../addon/mode/overlay"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../python/python","../stex/stex","../../addon/mode/overlay"],a);else a(CodeMirror)})(function(a){"use strict";a.defineMode("rst",function(b,c){var d=/^\*\*[^\*\s](?:[^\*]*[^\*\s])?\*\*/;var e=/^\*[^\*\s](?:[^\*]*[^\*\s])?\*/;var f=/^``[^`\s](?:[^`]*[^`\s])``/;var g=/^(?:[\d]+(?:[\.,]\d+)*)/;var h=/^(?:\s\+[\d]+(?:[\.,]\d+)*)/;var i=/^(?:\s\-[\d]+(?:[\.,]\d+)*)/;var j="[Hh][Tt][Tt][Pp][Ss]?://";var k="(?:[\\d\\w.-]+)\\.(?:\\w{2,6})";var l="(?:/[\\d\\w\\#\\%\\&\\-\\.\\,\\/\\:\\=\\?\\~]+)*";var m=new RegExp("^"+j+k+l);var n={token:function(a){if(a.match(d)&&a.match(/\W+|$/,false))return"strong";if(a.match(e)&&a.match(/\W+|$/,false))return"em";if(a.match(f)&&a.match(/\W+|$/,false))return"string-2";if(a.match(g))return"number";if(a.match(h))return"positive";if(a.match(i))return"negative";if(a.match(m))return"link";while(a.next()!=null){if(a.match(d,false))break;if(a.match(e,false))break;if(a.match(f,false))break;if(a.match(g,false))break;if(a.match(h,false))break;if(a.match(i,false))break;if(a.match(m,false))break}return null}};var o=a.getMode(b,c.backdrop||"rst-base");return a.overlayMode(o,n,true)},"python","stex");a.defineMode("rst-base",function(b){function c(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return typeof b[c]!="undefined"?b[c]:a})}var d=a.getMode(b,"python");var e=a.getMode(b,"stex");var f="\\s+";var g="(?:\\s*|\\W|$)",h=new RegExp(c("^{0}",g));var i="(?:[^\\W\\d_](?:[\\w!\"#$%&'()\\*\\+,\\-\\./:;<=>\\?]*[^\\W_])?)",j=new RegExp(c("^{0}",i));var k="(?:[^\\W\\d_](?:[\\w\\s!\"#$%&'()\\*\\+,\\-\\./:;<=>\\?]*[^\\W_])?)";var l=c("(?:{0}|`{1}`)",i,k);var m="(?:[^\\s\\|](?:[^\\|]*[^\\s\\|])?)";var n="(?:[^\\`]+)",o=new RegExp(c("^{0}",n));var p=new RegExp("^([!'#$%&\"()*+,-./:;<=>?@\\[\\\\\\]^_`{|}~])\\1{3,}\\s*$");var q=new RegExp(c("^\\.\\.{0}",f));var r=new RegExp(c("^_{0}:{1}|^__:{1}",l,g));var s=new RegExp(c("^{0}::{1}",l,g));var t=new RegExp(c("^\\|{0}\\|{1}{2}::{3}",m,f,l,g));var u=new RegExp(c("^\\[(?:\\d+|#{0}?|\\*)]{1}",l,g));var v=new RegExp(c("^\\[{0}\\]{1}",l,g));var w=new RegExp(c("^\\|{0}\\|",m));var x=new RegExp(c("^\\[(?:\\d+|#{0}?|\\*)]_",l));var y=new RegExp(c("^\\[{0}\\]_",l));var z=new RegExp(c("^{0}__?",l));var A=new RegExp(c("^`{0}`_",n));var B=new RegExp(c("^:{0}:`{1}`{2}",i,n,g));var C=new RegExp(c("^`{1}`:{0}:{2}",i,n,g));var D=new RegExp(c("^:{0}:{1}",i,g));var E=new RegExp(c("^{0}",l));var F=new RegExp(c("^::{0}",g));var G=new RegExp(c("^\\|{0}\\|",m));var H=new RegExp(c("^{0}",f));var I=new RegExp(c("^{0}",l));var J=new RegExp(c("^::{0}",g));var K=new RegExp("^_");var L=new RegExp(c("^{0}|_",l));var M=new RegExp(c("^:{0}",g));var N=new RegExp("^::\\s*$");var O=new RegExp("^\\s+(?:>>>|In \\[\\d+\\]:)\\s");function P(b,c){var f=null;if(b.sol()&&b.match(O,false)){W(c,U,{mode:d,local:a.startState(d)})}else if(b.sol()&&b.match(q)){W(c,Q);f="meta"}else if(b.sol()&&b.match(p)){W(c,P);f="header"}else if(Y(c)==B||b.match(B,false)){switch(X(c)){case 0:W(c,P,V(B,1));b.match(/^:/);f="meta";break;case 1:W(c,P,V(B,2));b.match(j);f="keyword";if(b.current().match(/^(?:math|latex)/)){c.tmp_stex=true}break;case 2:W(c,P,V(B,3));b.match(/^:`/);f="meta";break;case 3:if(c.tmp_stex){c.tmp_stex=undefined;c.tmp={mode:e,local:a.startState(e)}}if(c.tmp){if(b.peek()=="`"){W(c,P,V(B,4));c.tmp=undefined;break}f=c.tmp.mode.token(b,c.tmp.local);break}W(c,P,V(B,4));b.match(o);f="string";break;case 4:W(c,P,V(B,5));b.match(/^`/);f="meta";break;case 5:W(c,P,V(B,6));b.match(h);break;default:W(c,P)}}else if(Y(c)==C||b.match(C,false)){switch(X(c)){case 0:W(c,P,V(C,1));b.match(/^`/);f="meta";break;case 1:W(c,P,V(C,2));b.match(o);f="string";break;case 2:W(c,P,V(C,3));b.match(/^`:/);f="meta";break;case 3:W(c,P,V(C,4));b.match(j);f="keyword";break;case 4:W(c,P,V(C,5));b.match(/^:/);f="meta";break;case 5:W(c,P,V(C,6));b.match(h);break;default:W(c,P)}}else if(Y(c)==D||b.match(D,false)){switch(X(c)){case 0:W(c,P,V(D,1));b.match(/^:/);f="meta";break;case 1:W(c,P,V(D,2));b.match(j);f="keyword";break;case 2:W(c,P,V(D,3));b.match(/^:/);f="meta";break;case 3:W(c,P,V(D,4));b.match(h);break;default:W(c,P)}}else if(Y(c)==w||b.match(w,false)){switch(X(c)){case 0:W(c,P,V(w,1));b.match(G);f="variable-2";break;case 1:W(c,P,V(w,2));if(b.match(/^_?_?/))f="link";break;default:W(c,P)}}else if(b.match(x)){W(c,P);f="quote"}else if(b.match(y)){W(c,P);f="quote"}else if(b.match(z)){W(c,P);if(!b.peek()||b.peek().match(/^\W$/)){f="link"}}else if(Y(c)==A||b.match(A,false)){switch(X(c)){case 0:if(!b.peek()||b.peek().match(/^\W$/)){W(c,P,V(A,1))}else{b.match(A)}break;case 1:W(c,P,V(A,2));b.match(/^`/);f="link";break;case 2:W(c,P,V(A,3));b.match(o);break;case 3:W(c,P,V(A,4));b.match(/^`_/);f="link";break;default:W(c,P)}}else if(b.match(N)){W(c,S)}else{if(b.next())W(c,P)}return f}function Q(b,c){var f=null;if(Y(c)==t||b.match(t,false)){switch(X(c)){case 0:W(c,Q,V(t,1));b.match(G);f="variable-2";break;case 1:W(c,Q,V(t,2));b.match(H);break;case 2:W(c,Q,V(t,3));b.match(I);f="keyword";break;case 3:W(c,Q,V(t,4));b.match(J);f="meta";break;default:W(c,P)}}else if(Y(c)==s||b.match(s,false)){switch(X(c)){case 0:W(c,Q,V(s,1));b.match(E);f="keyword";if(b.current().match(/^(?:math|latex)/))c.tmp_stex=true;else if(b.current().match(/^python/))c.tmp_py=true;break;case 1:W(c,Q,V(s,2));b.match(F);f="meta";if(b.match(/^latex\s*$/)||c.tmp_stex){c.tmp_stex=undefined;W(c,U,{mode:e,local:a.startState(e)})}break;case 2:W(c,Q,V(s,3));if(b.match(/^python\s*$/)||c.tmp_py){c.tmp_py=undefined;W(c,U,{mode:d,local:a.startState(d)})}break;default:W(c,P)}}else if(Y(c)==r||b.match(r,false)){switch(X(c)){case 0:W(c,Q,V(r,1));b.match(K);b.match(L);f="link";break;case 1:W(c,Q,V(r,2));b.match(M);f="meta";break;default:W(c,P)}}else if(b.match(u)){W(c,P);f="quote"}else if(b.match(v)){W(c,P);f="quote"}else{b.eatSpace();if(b.eol()){W(c,P)}else{b.skipToEnd();W(c,R);f="comment"}}return f}function R(a,b){return T(a,b,"comment")}function S(a,b){return T(a,b,"meta")}function T(a,b,c){if(a.eol()||a.eatSpace()){a.skipToEnd();return c}else{W(b,P);return null}}function U(a,b){if(b.ctx.mode&&b.ctx.local){if(a.sol()){if(!a.eatSpace())W(b,P);return null}return b.ctx.mode.token(a,b.ctx.local)}W(b,P);return null}function V(a,b,c,d){return{phase:a,stage:b,mode:c,local:d}}function W(a,b,c){a.tok=b;a.ctx=c||{}}function X(a){return a.ctx.stage||0}function Y(a){return a.ctx.phase}return{startState:function(){return{tok:P,ctx:V(undefined,0)}},copyState:function(b){var c=b.ctx,d=b.tmp;if(c.local)c={mode:c.mode,local:a.copyState(c.mode,c.local)};if(d)d={mode:d.mode,local:a.copyState(d.mode,d.local)};return{tok:b.tok,ctx:c,tmp:d}},innerMode:function(a){return a.tmp?{state:a.tmp.local,mode:a.tmp.mode}:a.ctx.mode?{state:a.ctx.local,mode:a.ctx.mode}:null},token:function(a,b){return b.tok(a,b)}}},"python","stex");a.defineMIME("text/x-rst","rst")});
//# sourceMappingURL=rst.min.js.map