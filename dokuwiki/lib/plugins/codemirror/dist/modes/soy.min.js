(function(a){if(typeof exports=="object"&&typeof module=="object")a(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../htmlmixed/htmlmixed"],a);else a(CodeMirror)})(function(a){"use strict";var b=["template","literal","msg","fallbackmsg","let","if","elseif","else","switch","case","default","foreach","ifempty","for","call","param","deltemplate","delcall","log"];a.defineMode("soy",function(c){var d=a.getMode(c,"text/plain");var e={html:a.getMode(c,{name:"text/html",multilineTagIndentFactor:2,multilineTagIndentPastTag:false}),attributes:d,text:d,uri:d,css:a.getMode(c,"text/css"),js:a.getMode(c,{name:"text/javascript",statementIndent:2*c.indentUnit})};function f(a){return a[a.length-1]}function g(a,b,c){var d=a.string;var e=c.exec(d.substr(a.pos));if(e){a.string=d.substr(0,a.pos+e.index)}var f=a.hideFirstChars(b.indent,function(){return b.localMode.token(a,b.localState)});a.string=d;return f}return{startState:function(){return{kind:[],kindTag:[],soyState:[],indent:0,localMode:e.html,localState:a.startState(e.html)}},copyState:function(b){return{tag:b.tag,kind:b.kind.concat([]),kindTag:b.kindTag.concat([]),soyState:b.soyState.concat([]),indent:b.indent,localMode:b.localMode,localState:a.copyState(b.localMode,b.localState)}},token:function(d,h){var i;switch(f(h.soyState)){case"comment":if(d.match(/^.*?\*\//)){h.soyState.pop()}else{d.skipToEnd()}return"comment";case"variable":if(d.match(/^}/)){h.indent-=2*c.indentUnit;h.soyState.pop();return"variable-2"}d.next();return null;case"tag":if(d.match(/^\/?}/)){if(h.tag=="/template"||h.tag=="/deltemplate")h.indent=0;else h.indent-=(d.current()=="/}"||b.indexOf(h.tag)==-1?2:1)*c.indentUnit;h.soyState.pop();return"keyword"}else if(d.match(/^([\w?]+)(?==)/)){if(d.current()=="kind"&&(i=d.match(/^="([^"]+)/,false))){var j=i[1];h.kind.push(j);h.kindTag.push(h.tag);h.localMode=e[j]||e.html;h.localState=a.startState(h.localMode)}return"attribute"}else if(d.match(/^"/)){h.soyState.push("string");return"string"}d.next();return null;case"literal":if(d.match(/^(?=\{\/literal})/)){h.indent-=c.indentUnit;h.soyState.pop();return this.token(d,h)}return g(d,h,/\{\/literal}/);case"string":if(d.match(/^.*?"/)){h.soyState.pop()}else{d.skipToEnd()}return"string"}if(d.match(/^\/\*/)){h.soyState.push("comment");return"comment"}else if(d.match(d.sol()?/^\s*\/\/.*/:/^\s+\/\/.*/)){return"comment"}else if(d.match(/^\{\$[\w?]*/)){h.indent+=2*c.indentUnit;h.soyState.push("variable");return"variable-2"}else if(d.match(/^\{literal}/)){h.indent+=c.indentUnit;h.soyState.push("literal");return"keyword"}else if(i=d.match(/^\{([\/@\\]?[\w?]*)/)){if(i[1]!="/switch")h.indent+=(/^(\/|(else|elseif|case|default)$)/.test(i[1])&&h.tag!="switch"?1:2)*c.indentUnit;h.tag=i[1];if(h.tag=="/"+f(h.kindTag)){h.kind.pop();h.kindTag.pop();h.localMode=e[f(h.kind)]||e.html;h.localState=a.startState(h.localMode)}h.soyState.push("tag");return"keyword"}return g(d,h,/\{|\s+\/\/|\/\*/)},indent:function(b,d){var e=b.indent,g=f(b.soyState);if(g=="comment")return a.Pass;if(g=="literal"){if(/^\{\/literal}/.test(d))e-=c.indentUnit}else{if(/^\s*\{\/(template|deltemplate)\b/.test(d))return 0;if(/^\{(\/|(fallbackmsg|elseif|else|ifempty)\b)/.test(d))e-=c.indentUnit;if(b.tag!="switch"&&/^\{(case|default)\b/.test(d))e-=c.indentUnit;if(/^\{\/switch\b/.test(d))e-=c.indentUnit}if(e&&b.localMode.indent)e+=b.localMode.indent(b.localState,d);return e},innerMode:function(a){if(a.soyState.length&&f(a.soyState)!="literal")return null;else return{state:a.localState,mode:a.localMode}},electricInput:/^\s*\{(\/|\/template|\/deltemplate|\/switch|fallbackmsg|elseif|else|case|default|ifempty|\/literal\})$/,lineComment:"//",blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * ",fold:"indent"}},"htmlmixed");a.registerHelper("hintWords","soy",b.concat(["delpackage","namespace","alias","print","css","debugger"]));a.defineMIME("text/x-soy","soy")});
//# sourceMappingURL=soy.min.js.map